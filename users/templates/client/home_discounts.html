{% include 'promotions/navbar.html' %}

<body>
    <div class="container-fluid">
        <!-- Navigation Buttons -->
        <a href="{% url 'client_discounts' %}" class="btn btn-primary">Add client Discount</a>
        <a href="{% url 'home' %}" class="btn btn-primary">Return to homepage</a>
        <a href="{% url 'upload_excel_discount' %}" class="btn btn-secondary float-right">Upload from excel</a>
        
        <h1>List Clients Discounts</h1>
        
        <!-- Search Form -->
        <div class="d-flex justify-content-center align-items-center mb-4">
            <form method="post" action="{% url 'search_client_discount' %}" class="form-inline">
                {% csrf_token %}
                <input type="text" class="form-control mr-2" name="query" placeholder="Search client">
                <select name="search_by" class="form-control mr-2">
                    <option value="Client_Code">Code Client</option>
                </select>
                <button type="submit" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                    </svg>
                </button>
            </form>
        </div>
        {% if clients %}
        <div class="mt-4">
            <h2>Search results</h2>
        <!-- Clients Table -->
        <form method="post" action="{% url 'delete_selected_clients' %}">
            <button type="submit" class="btn btn-danger mt-3">Delete Selected</button>
            {% csrf_token %}
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="select-all"></th>
                        <th>Client Code</th>
                        <th>Trx_Code</th>
                        <th>Discounts</th>
                        <th>Month</th>
                        <th>Years</th>
                        <th>Discounts label</th>
                        <th>Applied</th>
                        <th>Stamp_Date</th>
                        <th>Affected item code</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for client in clients %}
                    <tr>
                        <td><input type="checkbox" class="client-checkbox" name="client_ids" value="{{ client.Client_Code }}"></td>
                        <td>{{ client.Client_Code }}</td>
                        <td>{{ client.Trx_Code }}</td>
                        <td>{{ client.Discounts }}</td>
                        <td>{{ client.Month }}</td>
                        <td>{{ client.Years }}</td>
                        <td>{{ client.Discounts_label }}</td>
                        <td>{{ client.Applied }}</td>
                        <td>{{ client.Stamp_Date }}</td>
                        <td>{{ client.Affected_item_code }}</td>
                        <td>
                            <a href="{% url 'client_discounts_edit' client.Client_Code %}" class="btn btn-warning btn-sm">Edit</a>

                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
    </div>
    {% elif query %}
    <div class="mt-4">
        <p>Aucun client ne correspond Ã  ce code client.</p>
    </div>
    {% endif %}
    </div>

        <script>
            document.getElementById('select-all').onclick = function() {
                var checkboxes = document.querySelectorAll('.client-checkbox');
                for (var checkbox of checkboxes) {
                    checkbox.checked = this.checked;
                }
            }
        </script>
</body>
</html>